'use strict';

/*Users tokens*/

const  jwt = require('jwt-simple'), // instance of jwt-simple
       moment = require('moment'), // instance of moment
       SEED = require('./config.txt').SEED; // SEED for token

exports.createToken = function(user){
    var payload = {
        sub           : user.uuid,
        name          : user.userName,
        email           : user.email,
        iat: moment().unix(), // Creation date of the token
        exp: moment().add(2, 'hour').unix() // Expiration date of the token
    };

    return jwt.encode(payload, SEED); // esto genera un hash
};

exports.decodeToken = function (token, SEED) {
    return jwt.decode(token,SEED);
};